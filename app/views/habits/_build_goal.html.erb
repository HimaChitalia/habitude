<%= form_for @habit, :as => :habit, :url => update_goals_path(@habit.id), method: :patch do |f| %>
  <%= f.fields_for :goals, @habit.goals.build do |goal_builder| %>
    <%= goal_builder.label :name %>
    <%= goal_builder.text_field :name %>
  <% end %><br>

  <%= f.submit value="Add a goal"%>
<% end %>

<script type="text/javascript" charset="utf-8">
  $(function () {
    $('form').submit(function(event) {
      event.preventDefault();
      var values = $(this).serialize();
      var myString = this.action
      var path = myString.replace('http://localhost:3000/habits/','');
      var posting = $.post(path, values);
      var goalValue = $("input[id=habit_goals_attributes_0_name]").val()
      posting.success(function(data) {
        alert("Awesome! You have new goal for this habit -" + goalValue)
      });
    });
  });
</script>
